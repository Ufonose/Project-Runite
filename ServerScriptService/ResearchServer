local RepStorage = game:GetService("ReplicatedStorage")
local ServerStorage = game:GetService("ServerStorage")
local ResearchHandler = require(ServerStorage.Modules.ResearchHandler)
local ResearchData = require(ServerStorage.Modules.ResearchData)

-- Get research data for player
RepStorage.Events.GetResearchData.OnServerInvoke = function(player)
	local research = ResearchHandler.GetPlayerResearch(player)

	return {
		CompletedObjectives = research.CompletedObjectives,
		ActiveObjectives = research.ActiveObjectives,
		ObjectiveProgress = research.ObjectiveProgress,
		ResearchTokens = player.ResearchTokens.Value,
		AllObjectives = ResearchData.Objectives,
	}
end

-- Start an objective
RepStorage.Events.StartObjective.OnServerInvoke = function(player, objectiveId)
	return ResearchHandler.StartObjective(player, objectiveId)
end

-- REMOVED: ToggleResearchMode function (no longer needed - always both modes)

-- Get which research unlocks a specific item
RepStorage.Events.GetItemUnlockRequirement.OnServerInvoke = function(player, itemId)
	return ResearchData.GetUnlockingResearch(itemId)
end
