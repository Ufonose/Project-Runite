local module = {}

function module.LOAD(MODULE_INFO)
	-- Basic Needs
	local MODULES = MODULE_INFO["MODULES"]
	local SERVICES = MODULE_INFO["SERVICES"]
	-- Services
	local RepStorage = SERVICES["ReplicatedStorage"]
	local Plrs = SERVICES["Players"]
	-- Modules
	local PLACEMENT = MODULES["Placement"]
	local CASH_LIB = MODULES["CashLib"]
	local Main = MODULES["Main"]
	local SoundManager = require(RepStorage.Modules.SoundManager)
	-- Plr Info
	local Plr = Plrs.LocalPlayer
	-- Services for mobile control management
	local GuiService = game:GetService("GuiService")
	local UserInputService = game:GetService("UserInputService")
	-- Check if player is on mobile device
	local isMobile = UserInputService.TouchEnabled and not UserInputService.KeyboardEnabled
	-- Variables
	local DB = true
	local AMOUNT = 1
	local CURRENT_COST = 0
	local CURRENT_TAB = "AllTab"
	local SELECTED_ITEM
	local INV
	local LOAD_SHOP  -- Forward declaration

	-- Reference screen size for scale calculations: 1920x1080
	-- Create main shop frame with modern styling - RESPONSIVE (100% BIGGER - DOUBLED SIZE)
	local shopFrame = Instance.new("Frame")
	shopFrame.Name = "ShopFrame"
	-- Detect screen size and adjust GUI size for mobile
	local function updateShopSize()
		local viewport = workspace.CurrentCamera.ViewportSize
		local screenWidth = viewport.X

		-- If screen width is less than 800 pixels (mobile/tablet), make GUI bigger
		if screenWidth < 900 then
			shopFrame.Size = UDim2.new(1.5, 0, 1.35, 0)  -- 95% on mobile (almost fullscreen)
		else
			shopFrame.Size = UDim2.new(1.2, 0, 1.3, 0)  -- 85% on desktop
		end
	end

	-- Update on initial load
	updateShopSize()

	-- Update when screen size changes (device rotation, window resize)
	workspace.CurrentCamera:GetPropertyChangedSignal("ViewportSize"):Connect(updateShopSize)
	shopFrame.Position = UDim2.new(1, 0, 1, 0)  -- Bottom right corner
	shopFrame.AnchorPoint = Vector2.new(1, 1)  -- Bottom right anchor point
	shopFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
	shopFrame.BackgroundTransparency = 0.1
	shopFrame.BorderSizePixel = 0
	shopFrame.Visible = false
	shopFrame.ZIndex = 5
	shopFrame.Parent = script.Parent

	-- UIAspectRatioConstraint to maintain original proportions (560/900 = 0.6222)
	local aspectRatio = Instance.new("UIAspectRatioConstraint")
	aspectRatio.AspectRatio = 0.6222
	aspectRatio.DominantAxis = Enum.DominantAxis.Height  -- Scale based on height
	aspectRatio.Parent = shopFrame

	-- Blur/Glass effect background
	local blur = Instance.new("Frame")
	blur.Size = UDim2.new(1, 0, 1, 0)
	blur.BackgroundColor3 = Color3.fromRGB(15, 15, 20)
	blur.BackgroundTransparency = 0.3
	blur.BorderSizePixel = 0
	blur.ZIndex = 6
	blur.Parent = shopFrame

	local blurCorner = Instance.new("UICorner")
	blurCorner.CornerRadius = UDim.new(0, 15)
	blurCorner.Parent = blur

	-- Outer glow/shadow
	local stroke = Instance.new("UIStroke")
	stroke.Color = Color3.fromRGB(60, 60, 80)
	stroke.Thickness = 2
	stroke.Transparency = 0.5
	stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
	stroke.Parent = shopFrame

	local shopCorner = Instance.new("UICorner")
	shopCorner.CornerRadius = UDim.new(0, 15)
	shopCorner.Parent = shopFrame

	-- Title bar with modern styling (converted to scale: 50/900 height)
	local titleBar = Instance.new("Frame")
	titleBar.Name = "TitleBar"
	titleBar.Size = UDim2.new(1, 0, 0.0556, 0)  -- Full width, 50/900 = 0.0556
	titleBar.BackgroundColor3 = Color3.fromRGB(20, 20, 25)
	titleBar.BorderSizePixel = 0
	titleBar.ZIndex = 7
	titleBar.Parent = shopFrame

	local titleCorner = Instance.new("UICorner")
	titleCorner.CornerRadius = UDim.new(0, 15)
	titleCorner.Parent = titleBar

	-- Cover for bottom of title bar (converted to scale: 15/50 = 0.3 of titleBar height)
	local titleCover = Instance.new("Frame")
	titleCover.Size = UDim2.new(1, 0, 0.3, 0)  -- Full width, 15/50 = 0.3 of titleBar
	titleCover.Position = UDim2.new(0, 0, 1, 0)  -- Bottom of titleBar
	titleCover.AnchorPoint = Vector2.new(0, 1)
	titleCover.BackgroundColor3 = Color3.fromRGB(20, 20, 25)
	titleCover.BorderSizePixel = 0
	titleCover.ZIndex = 7
	titleCover.Parent = titleBar

	-- Title text (converted to scale: (560-120)/560 = 0.7857 width, 60/560 = 0.1071 position)
	local titleText = Instance.new("TextLabel")
	titleText.Size = UDim2.new(0.7857, 0, 1, 0)  -- Width minus space for close button
	titleText.Position = UDim2.new(0.1071, 0, 0, 0)  -- Centered with offset
	titleText.BackgroundTransparency = 1
	titleText.Text = "Shop"
	titleText.TextColor3 = Color3.fromRGB(255, 255, 255)
	titleText.TextSize = 28
	titleText.Font = Enum.Font.GothamBold
	titleText.TextXAlignment = Enum.TextXAlignment.Center
	titleText.TextScaled = true
	titleText.ZIndex = 8
	titleText.Parent = titleBar

	-- Text size constraint for titleText
	local titleTextConstraint = Instance.new("UITextSizeConstraint")
	titleTextConstraint.MaxTextSize = 28
	titleTextConstraint.Parent = titleText

	-- Close button (converted to scale: 40/560 = 0.0714 width, 40/50 = 0.8 height)
	local closeButton = Instance.new("TextButton")
	closeButton.Size = UDim2.new(0.0714, 0, 0.8, 0)  -- Proportional to frame
	closeButton.Position = UDim2.new(0.9196, 0, 0.1, 0)  -- (560-45)/560 = 0.9196, 5/50 = 0.1
	closeButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
	closeButton.BackgroundTransparency = 0
	closeButton.Text = "X"
	closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
	closeButton.TextSize = 22
	closeButton.Font = Enum.Font.GothamBold
	closeButton.TextScaled = true
	closeButton.ZIndex = 8
	closeButton.Parent = titleBar

	-- Text size constraint for closeButton
	local closeTextConstraint = Instance.new("UITextSizeConstraint")
	closeTextConstraint.MaxTextSize = 22
	closeTextConstraint.Parent = closeButton

	local closeCorner = Instance.new("UICorner")
	closeCorner.CornerRadius = UDim.new(0, 10)
	closeCorner.Parent = closeButton

	-- Close button stroke
	local closeStroke = Instance.new("UIStroke")
	closeStroke.Color = Color3.fromRGB(0, 0, 0)
	closeStroke.Thickness = 1
	closeStroke.Transparency = 0.7
	closeStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
	closeStroke.Parent = closeButton

	-- ADD THIS RIGHT HERE - AFTER CLOSE BUTTON IS CREATED:
	-- Function to update close button size for mobile
	local function updateCloseButtonSize()
		local viewport = workspace.CurrentCamera.ViewportSize
		local screenWidth = viewport.X

		if screenWidth < 900 then  -- Match your shop size threshold
			-- Mobile: Make button bigger (1.5x size)
			closeButton.Size = UDim2.new(0.107, 0, 1.2, 0)
			closeButton.Position = UDim2.new(0.88, 0, -0.1, 0)
		else
			-- Desktop: Normal size
			closeButton.Size = UDim2.new(0.0714, 0, 0.8, 0)
			closeButton.Position = UDim2.new(0.9196, 0, 0.1, 0)
		end
	end

	-- Update on initial load
	updateCloseButtonSize()

	-- Update when screen size changes
	workspace.CurrentCamera:GetPropertyChangedSignal("ViewportSize"):Connect(updateCloseButtonSize)
	-- END OF ADDITION

	closeButton.MouseButton1Click:Connect(function()
		Main.CLOSE_MENU(script.Parent)
		shopFrame.Visible = false
	end)

	-- Category and search bar frame (converted to scale: 520/560 = 0.9286 width, 80/900 = 0.0889 height)
	local topFrame = Instance.new("Frame")
	topFrame.Size = UDim2.new(0.9286, 0, 0.0889, 0)  -- (560-40)/560 width, 80/900 height
	topFrame.Position = UDim2.new(0.0357, 0, 0.0667, 0)  -- 20/560 = 0.0357, 60/900 = 0.0667
	topFrame.BackgroundTransparency = 1
	topFrame.ZIndex = 7
	topFrame.Parent = shopFrame

	-- Search bar (converted to scale: full width, 35/80 = 0.4375 height)
	local searchFrame = Instance.new("Frame")
	searchFrame.Size = UDim2.new(1, 0, 0.4375, 0)  -- Full width of topFrame, 35/80 height
	searchFrame.Position = UDim2.new(0, 0, 0, 0)
	searchFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
	searchFrame.BorderSizePixel = 0
	searchFrame.ZIndex = 8
	searchFrame.Parent = topFrame

	local searchCorner = Instance.new("UICorner")
	searchCorner.CornerRadius = UDim.new(0, 10)
	searchCorner.Parent = searchFrame

	-- Search frame stroke
	local searchStroke = Instance.new("UIStroke")
	searchStroke.Color = Color3.fromRGB(60, 60, 80)
	searchStroke.Thickness = 1
	searchStroke.Transparency = 0.6
	searchStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
	searchStroke.Parent = searchFrame

	local searchIcon = Instance.new("TextLabel")
	searchIcon.Size = UDim2.new(0.0577, 0, 1, 0)  -- 30/520 = 0.0577 (relative to topFrame width)
	searchIcon.Position = UDim2.new(0.0192, 0, 0, 0)  -- 10/520 = 0.0192
	searchIcon.BackgroundTransparency = 1
	searchIcon.Text = "ðŸ”"
	searchIcon.TextSize = 16
	searchIcon.TextScaled = true
	searchIcon.ZIndex = 9
	searchIcon.Parent = searchFrame

	-- Text size constraint for searchIcon
	local searchIconConstraint = Instance.new("UITextSizeConstraint")
	searchIconConstraint.MaxTextSize = 16
	searchIconConstraint.Parent = searchIcon

	local searchBox = Instance.new("TextBox")
	searchBox.Size = UDim2.new(0.8462, 0, 1, 0)  -- (520-80)/520 = 440/520 = 0.8462
	searchBox.Position = UDim2.new(0.0769, 0, 0, 0)  -- 40/520 = 0.0769
	searchBox.BackgroundTransparency = 1
	searchBox.Text = ""
	searchBox.PlaceholderText = "Search..."
	searchBox.TextColor3 = Color3.fromRGB(255, 255, 255)
	searchBox.PlaceholderColor3 = Color3.fromRGB(120, 120, 120)
	searchBox.TextSize = 13
	searchBox.Font = Enum.Font.Gotham
	searchBox.TextXAlignment = Enum.TextXAlignment.Left
	searchBox.TextScaled = true
	searchBox.ClearTextOnFocus = false
	searchBox.ZIndex = 9
	searchBox.Parent = searchFrame

	-- Text size constraint for searchBox
	local searchBoxConstraint = Instance.new("UITextSizeConstraint")
	searchBoxConstraint.MaxTextSize = 13
	searchBoxConstraint.Parent = searchBox

	local clearButton = Instance.new("TextButton")
	clearButton.Size = UDim2.new(0.0538, 0, 0.8, 0)  -- 28/520 = 0.0538, 28/35 = 0.8
	clearButton.Position = UDim2.new(0.9385, 0, 0.1, 0)  -- (520-32)/520 = 0.9385, centered
	clearButton.AnchorPoint = Vector2.new(0, 0)
	clearButton.BackgroundColor3 = Color3.fromRGB(50, 50, 55)
	clearButton.Text = "X"
	clearButton.TextColor3 = Color3.fromRGB(200, 200, 200)
	clearButton.TextSize = 14
	clearButton.Font = Enum.Font.GothamBold
	clearButton.TextScaled = true
	clearButton.Visible = false
	clearButton.ZIndex = 9
	clearButton.Parent = searchFrame

	-- Text size constraint for clearButton
	local clearTextConstraint = Instance.new("UITextSizeConstraint")
	clearTextConstraint.MaxTextSize = 14
	clearTextConstraint.Parent = clearButton

	local clearCorner = Instance.new("UICorner")
	clearCorner.CornerRadius = UDim.new(1, 0)
	clearCorner.Parent = clearButton

	clearButton.MouseButton1Click:Connect(function()
		searchBox.Text = ""
	end)

	-- Category buttons container (converted to scale: full width, 35/80 = 0.4375 height)
	local categoryFrame = Instance.new("Frame")
	categoryFrame.Size = UDim2.new(1, 0, 0.4375, 0)  -- Full width, 35/80 height
	categoryFrame.Position = UDim2.new(0, 0, 0.5625, 0)  -- 45/80 = 0.5625
	categoryFrame.BackgroundTransparency = 1
	categoryFrame.ZIndex = 7
	categoryFrame.Parent = topFrame

	local categoryLayout = Instance.new("UIListLayout")
	categoryLayout.FillDirection = Enum.FillDirection.Horizontal
	categoryLayout.Padding = UDim.new(0.0154, 0)  -- 8/520 = 0.0154
	categoryLayout.SortOrder = Enum.SortOrder.LayoutOrder
	categoryLayout.Parent = categoryFrame

	-- "All" button (converted to scale: 110/520 = 0.2115 width, full height)
	local allButton = Instance.new("TextButton")
	allButton.Name = "AllTab"
	allButton.Size = UDim2.new(0.23845, 0, 1, 0)  -- 110/520 width
	allButton.BackgroundColor3 = Color3.fromRGB(100, 70, 140)
	allButton.BackgroundTransparency = 0
	allButton.Text = "All"
	allButton.TextColor3 = Color3.fromRGB(255, 255, 255)
	allButton.TextSize = 14
	allButton.Font = Enum.Font.GothamBold
	allButton.TextScaled = true
	allButton.LayoutOrder = 0
	allButton.ZIndex = 8
	allButton.Parent = categoryFrame

	-- Text size constraint for allButton
	local allTextConstraint = Instance.new("UITextSizeConstraint")
	allTextConstraint.MaxTextSize = 14
	allTextConstraint.Parent = allButton

	local allCorner = Instance.new("UICorner")
	allCorner.CornerRadius = UDim.new(0, 10)
	allCorner.Parent = allButton

	-- All button stroke
	local allStroke = Instance.new("UIStroke")
	allStroke.Color = Color3.fromRGB(0, 0, 0)
	allStroke.Thickness = 1
	allStroke.Transparency = 0.7
	allStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
	allStroke.Parent = allButton

	-- Items scroll frame (converted to scale: 520/560 = 0.9286 width, 555/900 = 0.6167 height)
	local itemsScroll = Instance.new("ScrollingFrame")
	itemsScroll.Name = "ItemsScroll"
	itemsScroll.Size = UDim2.new(0.9286, 0, 0.6167, 0)  -- (560-40)/560 width, (900-345)/900 height
	itemsScroll.Position = UDim2.new(0.0357, 0, 0.1722, 0)  -- 20/560 = 0.0357, 155/900 = 0.1722
	itemsScroll.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
	itemsScroll.BackgroundTransparency = 0.3
	itemsScroll.BorderSizePixel = 0
	itemsScroll.ScrollBarThickness = 10
	itemsScroll.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 105)
	itemsScroll.ZIndex = 7
	itemsScroll.Parent = shopFrame

	local itemsCorner = Instance.new("UICorner")
	itemsCorner.CornerRadius = UDim.new(0, 12)
	itemsCorner.Parent = itemsScroll

	-- Items scroll stroke
	local itemsStroke = Instance.new("UIStroke")
	itemsStroke.Color = Color3.fromRGB(60, 60, 80)
	itemsStroke.Thickness = 1
	itemsStroke.Transparency = 0.6
	itemsStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
	itemsStroke.Parent = itemsScroll

	local itemsGrid = Instance.new("UIGridLayout")
	itemsGrid.SortOrder = Enum.SortOrder.LayoutOrder
	itemsGrid.Parent = itemsScroll

	-- Calculate responsive cell size based on scroll frame dimensions
	local function updateGridSize()
		local viewport = workspace.CurrentCamera.ViewportSize
		local screenWidth = viewport.X
		local scrollWidth = itemsScroll.AbsoluteSize.X

		-- Mobile: 2 columns with bigger items, Desktop: 3 columns
		local numColumns = (screenWidth < 900) and 2 or 3
		local cellWidth = (scrollWidth - 30) / numColumns - 10  -- Adjust for columns
		local cellHeight = cellWidth / 0.7381  -- Maintain 155:210 aspect ratio

		itemsGrid.CellSize = UDim2.new(0, cellWidth, 0, cellHeight)
		itemsGrid.CellPadding = UDim2.new(0, 10, 0, 10)
	end

	-- Update on initial load and when screen resizes
	updateGridSize()
	itemsScroll:GetPropertyChangedSignal("AbsoluteSize"):Connect(updateGridSize)

	local itemsPadding = Instance.new("UIPadding")
	itemsPadding.PaddingTop = UDim.new(0.027, 0)  -- 15/555 = 0.027 (relative to scroll content height)
	itemsPadding.PaddingBottom = UDim.new(0.027, 0)
	itemsPadding.PaddingLeft = UDim.new(0.0288, 0)  -- 15/520 = 0.0288 (relative to scroll content width)
	itemsPadding.PaddingRight = UDim.new(0.0288, 0)
	itemsPadding.Parent = itemsScroll

	-- Selected item panel (converted to scale: 520/560 = 0.9286 width, 170/900 = 0.1889 height)
	local selectedPanel = Instance.new("Frame")
	selectedPanel.Name = "SelectedPanel"
	selectedPanel.Size = UDim2.new(0.9286, 0, 0.1889, 0)  -- (560-40)/560 width, 170/900 height
	selectedPanel.Position = UDim2.new(0.0357, 0, 0.7944, 0)  -- 20/560 = 0.0357, (900-185)/900 = 0.7944
	selectedPanel.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
	selectedPanel.BackgroundTransparency = 0.2
	selectedPanel.BorderSizePixel = 0
	selectedPanel.Visible = false
	selectedPanel.ZIndex = 7
	selectedPanel.Parent = shopFrame

	local selectedCorner = Instance.new("UICorner")
	selectedCorner.CornerRadius = UDim.new(0, 12)
	selectedCorner.Parent = selectedPanel

	-- Selected panel stroke
	local selectedStroke = Instance.new("UIStroke")
	selectedStroke.Color = Color3.fromRGB(60, 60, 80)
	selectedStroke.Thickness = 2
	selectedStroke.Transparency = 0.5
	selectedStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
	selectedStroke.Parent = selectedPanel

	-- Selected item icon (converted to scale: 150/520 = 0.2885 width, 150/170 = 0.8824 height)
	local selectedIcon = Instance.new("ImageLabel")
	selectedIcon.Size = UDim2.new(0.2885, 0, 0.8824, 0)  -- 150/520 width, 150/170 height
	selectedIcon.Position = UDim2.new(0.0192, 0, 0.0588, 0)  -- 10/520 = 0.0192, 10/170 = 0.0588
	selectedIcon.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
	selectedIcon.BorderSizePixel = 0
	selectedIcon.ZIndex = 8
	selectedIcon.Parent = selectedPanel

	local selectedIconCorner = Instance.new("UICorner")
	selectedIconCorner.CornerRadius = UDim.new(0, 12)
	selectedIconCorner.Parent = selectedIcon

	-- Selected item info container (converted to scale: 340/520 = 0.6538 width, 150/170 = 0.8824 height)
	local infoContainer = Instance.new("Frame")
	infoContainer.Size = UDim2.new(0.6538, 0, 0.8824, 0)  -- (520-180)/520 width, (170-20)/170 height
	infoContainer.Position = UDim2.new(0.3269, 0, 0.0588, 0)  -- 170/520 = 0.3269, 10/170 = 0.0588
	infoContainer.BackgroundTransparency = 1
	infoContainer.ZIndex = 8
	infoContainer.Parent = selectedPanel

	-- Selected item name (converted to scale: full width, 22/150 = 0.1467 height)
	local selectedName = Instance.new("TextLabel")
	selectedName.Size = UDim2.new(1, 0, 0.1467, 0)  -- Full width, 22/150 height
	selectedName.Position = UDim2.new(0, 0, 0, 0)
	selectedName.BackgroundTransparency = 1
	selectedName.Text = "Item Name"
	selectedName.TextColor3 = Color3.fromRGB(255, 255, 255)
	selectedName.TextSize = 16
	selectedName.Font = Enum.Font.GothamBold
	selectedName.TextXAlignment = Enum.TextXAlignment.Left
	selectedName.TextTruncate = Enum.TextTruncate.AtEnd
	selectedName.TextScaled = true
	selectedName.ZIndex = 9
	selectedName.Parent = infoContainer

	-- Text size constraint for selectedName
	local selectedNameConstraint = Instance.new("UITextSizeConstraint")
	selectedNameConstraint.MaxTextSize = 16
	selectedNameConstraint.Parent = selectedName

	-- Selected item tier (converted to scale: full width, 16/150 = 0.1067 height, 24/150 = 0.16 position)
	local selectedTier = Instance.new("TextLabel")
	selectedTier.Size = UDim2.new(1, 0, 0.1067, 0)  -- Full width, 16/150 height
	selectedTier.Position = UDim2.new(0, 0, 0.16, 0)  -- 24/150 position
	selectedTier.BackgroundTransparency = 1
	selectedTier.Text = "First Age"
	selectedTier.TextColor3 = Color3.fromRGB(150, 150, 200)
	selectedTier.TextSize = 12
	selectedTier.Font = Enum.Font.Gotham
	selectedTier.TextXAlignment = Enum.TextXAlignment.Left
	selectedTier.TextScaled = true
	selectedTier.ZIndex = 9
	selectedTier.Parent = infoContainer

	-- Text size constraint for selectedTier
	local selectedTierConstraint = Instance.new("UITextSizeConstraint")
	selectedTierConstraint.MaxTextSize = 12
	selectedTierConstraint.Parent = selectedTier

	-- Selected item description (converted to scale: full width, 35/150 = 0.2333 height, 43/150 = 0.2867 position)
	local selectedDesc = Instance.new("TextLabel")
	selectedDesc.Size = UDim2.new(1, 0, 0.2333, 0)  -- Full width, 35/150 height
	selectedDesc.Position = UDim2.new(0, 0, 0.2867, 0)  -- 43/150 position
	selectedDesc.BackgroundTransparency = 1
	selectedDesc.Text = "Smelts 5 clean ores into valuable ingots!\nMix ores = impure ingot"
	selectedDesc.TextColor3 = Color3.fromRGB(180, 180, 190)
	selectedDesc.TextSize = 11
	selectedDesc.Font = Enum.Font.Gotham
	selectedDesc.TextWrapped = true
	selectedDesc.TextXAlignment = Enum.TextXAlignment.Left
	selectedDesc.TextYAlignment = Enum.TextYAlignment.Top
	selectedDesc.TextScaled = true
	selectedDesc.ZIndex = 9
	selectedDesc.Parent = infoContainer

	-- Text size constraint for selectedDesc
	local selectedDescConstraint = Instance.new("UITextSizeConstraint")
	selectedDescConstraint.MaxTextSize = 11
	selectedDescConstraint.Parent = selectedDesc

	-- Bottom controls row (converted to scale: full width, 70/150 = 0.4667 height, 80/150 = 0.5333 position)
	local controlsRow = Instance.new("Frame")
	controlsRow.Size = UDim2.new(1, 0, 0.4667, 0)  -- Full width, 70/150 height
	controlsRow.Position = UDim2.new(0, 0, 0.5333, 0)  -- (150-70)/150 = 0.5333
	controlsRow.BackgroundTransparency = 1
	controlsRow.ZIndex = 9
	controlsRow.Parent = infoContainer

	-- Amount controls (converted to scale: 110/340 = 0.3235 width, full height)
	local amountFrame = Instance.new("Frame")
	amountFrame.Size = UDim2.new(0.3235, 0, 1, 0)  -- 110/340 width
	amountFrame.Position = UDim2.new(0, 0, 0, 0)
	amountFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
	amountFrame.BackgroundTransparency = 0.3
	amountFrame.BorderSizePixel = 0
	amountFrame.ZIndex = 10
	amountFrame.Parent = controlsRow

	local amountCorner = Instance.new("UICorner")
	amountCorner.CornerRadius = UDim.new(0, 10)
	amountCorner.Parent = amountFrame

	-- Amount frame stroke
	local amountStroke = Instance.new("UIStroke")
	amountStroke.Color = Color3.fromRGB(60, 60, 80)
	amountStroke.Thickness = 1
	amountStroke.Transparency = 0.6
	amountStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
	amountStroke.Parent = amountFrame

	local decreaseBtn = Instance.new("TextButton")
	decreaseBtn.Size = UDim2.new(0.2727, 0, 1, 0)  -- 30/110 = 0.2727
	decreaseBtn.Position = UDim2.new(0, 0, 0, 0)
	decreaseBtn.BackgroundTransparency = 1
	decreaseBtn.Text = "âˆ’"
	decreaseBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
	decreaseBtn.TextSize = 20
	decreaseBtn.Font = Enum.Font.GothamBold
	decreaseBtn.TextScaled = true
	decreaseBtn.ZIndex = 11
	decreaseBtn.Parent = amountFrame

	-- Text size constraint for decreaseBtn
	local decreaseTextConstraint = Instance.new("UITextSizeConstraint")
	decreaseTextConstraint.MaxTextSize = 20
	decreaseTextConstraint.Parent = decreaseBtn

	local amountLabel = Instance.new("TextLabel")
	amountLabel.Size = UDim2.new(0.4545, 0, 1, 0)  -- (110-60)/110 = 50/110 = 0.4545
	amountLabel.Position = UDim2.new(0.2727, 0, 0, 0)  -- 30/110 = 0.2727
	amountLabel.BackgroundTransparency = 1
	amountLabel.Text = "1"
	amountLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
	amountLabel.TextSize = 16
	amountLabel.Font = Enum.Font.GothamBold
	amountLabel.TextScaled = true
	amountLabel.ZIndex = 11
	amountLabel.Parent = amountFrame

	-- Text size constraint for amountLabel
	local amountLabelConstraint = Instance.new("UITextSizeConstraint")
	amountLabelConstraint.MaxTextSize = 16
	amountLabelConstraint.Parent = amountLabel

	local increaseBtn = Instance.new("TextButton")
	increaseBtn.Size = UDim2.new(0.2727, 0, 1, 0)  -- 30/110 = 0.2727
	increaseBtn.Position = UDim2.new(0.7273, 0, 0, 0)  -- (110-30)/110 = 80/110 = 0.7273
	increaseBtn.BackgroundTransparency = 1
	increaseBtn.Text = "+"
	increaseBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
	increaseBtn.TextSize = 20
	increaseBtn.Font = Enum.Font.GothamBold
	increaseBtn.TextScaled = true
	increaseBtn.ZIndex = 11
	increaseBtn.Parent = amountFrame

	-- Text size constraint for increaseBtn
	local increaseTextConstraint = Instance.new("UITextSizeConstraint")
	increaseTextConstraint.MaxTextSize = 20
	increaseTextConstraint.Parent = increaseBtn

	-- Buttons container (converted to scale: 220/340 = 0.6471 width, 120/340 = 0.3529 position)
	local buttonsContainer = Instance.new("Frame")
	buttonsContainer.Size = UDim2.new(0.6471, 0, 1, 0)  -- (340-120)/340 width
	buttonsContainer.Position = UDim2.new(0.3529, 0, 0, 0)  -- 120/340 position
	buttonsContainer.BackgroundTransparency = 1
	buttonsContainer.ZIndex = 10
	buttonsContainer.Parent = controlsRow

	-- Buy button (converted to scale: full width, 33/70 = 0.4714 height)
	local buyButton = Instance.new("TextButton")
	buyButton.Size = UDim2.new(1, 0, 0.4714, 0)  -- Full width, 33/70 height
	buyButton.Position = UDim2.new(0, 0, 0, 0)
	buyButton.BackgroundColor3 = Color3.fromRGB(70, 130, 70)
	buyButton.BackgroundTransparency = 0
	buyButton.Text = "ðŸ’° Buy - $150"
	buyButton.TextColor3 = Color3.fromRGB(255, 255, 255)
	buyButton.TextSize = 14
	buyButton.Font = Enum.Font.GothamBold
	buyButton.TextScaled = true
	buyButton.ZIndex = 11
	buyButton.Parent = buttonsContainer

	-- Text size constraint for buyButton
	local buyTextConstraint = Instance.new("UITextSizeConstraint")
	buyTextConstraint.MaxTextSize = 14
	buyTextConstraint.Parent = buyButton

	local buyCorner = Instance.new("UICorner")
	buyCorner.CornerRadius = UDim.new(0, 10)
	buyCorner.Parent = buyButton

	-- Buy button stroke
	local buyStroke = Instance.new("UIStroke")
	buyStroke.Color = Color3.fromRGB(0, 0, 0)
	buyStroke.Thickness = 1
	buyStroke.Transparency = 0.7
	buyStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
	buyStroke.Parent = buyButton

	-- Cancel button (converted to scale: full width, 32/70 = 0.4571 height, 38/70 = 0.5429 position)
	local cancelButton = Instance.new("TextButton")
	cancelButton.Size = UDim2.new(1, 0, 0.4571, 0)  -- Full width, 32/70 height
	cancelButton.Position = UDim2.new(0, 0, 0.5429, 0)  -- (70-32)/70 = 38/70 = 0.5429
	cancelButton.BackgroundColor3 = Color3.fromRGB(70, 70, 75)
	cancelButton.BackgroundTransparency = 0
	cancelButton.Text = "Cancel"
	cancelButton.TextColor3 = Color3.fromRGB(255, 255, 255)
	cancelButton.TextSize = 14
	cancelButton.Font = Enum.Font.GothamBold
	cancelButton.TextScaled = true
	cancelButton.ZIndex = 11
	cancelButton.Parent = buttonsContainer

	-- Text size constraint for cancelButton
	local cancelTextConstraint = Instance.new("UITextSizeConstraint")
	cancelTextConstraint.MaxTextSize = 14
	cancelTextConstraint.Parent = cancelButton

	local cancelCorner = Instance.new("UICorner")
	cancelCorner.CornerRadius = UDim.new(0, 10)
	cancelCorner.Parent = cancelButton

	-- Cancel button stroke
	local cancelStroke = Instance.new("UIStroke")
	cancelStroke.Color = Color3.fromRGB(0, 0, 0)
	cancelStroke.Thickness = 1
	cancelStroke.Transparency = 0.7
	cancelStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
	cancelStroke.Parent = cancelButton

	-- Category buttons data (HARDCODED - DO NOT CHANGE)
	local categories = {
		{Name = "MineTab", Display = "Conveyors", Color = Color3.fromRGB(70, 100, 140)},
		{Name = "MachineTab", Display = "Machines", Color = Color3.fromRGB(16, 71, 60)},	
		{Name = "DecorTab", Display = "Decor", Color = Color3.fromRGB(140, 100, 70)},
	}

	-- Store category buttons for later reference
	local categoryButtons = {}

	-- Create category buttons
	for i, category in pairs(categories) do
		local tabButton = Instance.new("TextButton")
		tabButton.Name = category.Name
		tabButton.Size = UDim2.new(0.23845, 0, 1, 0)
		tabButton.BackgroundColor3 = Color3.fromRGB(40, 40, 45)  -- Start gray
		tabButton.BackgroundTransparency = 0
		tabButton.Text = category.Display
		tabButton.TextColor3 = Color3.fromRGB(255, 255, 255)
		tabButton.TextSize = 14
		tabButton.Font = Enum.Font.GothamBold
		tabButton.TextScaled = true
		tabButton.LayoutOrder = i
		tabButton.ZIndex = 8
		tabButton.Parent = categoryFrame

		-- Text size constraint for tabButton
		local tabTextConstraint = Instance.new("UITextSizeConstraint")
		tabTextConstraint.MaxTextSize = 14
		tabTextConstraint.Parent = tabButton

		local tabCorner = Instance.new("UICorner")
		tabCorner.CornerRadius = UDim.new(0, 10)
		tabCorner.Parent = tabButton

		-- Tab button stroke
		local tabStroke = Instance.new("UIStroke")
		tabStroke.Color = Color3.fromRGB(0, 0, 0)
		tabStroke.Thickness = 1
		tabStroke.Transparency = 0.7
		tabStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
		tabStroke.Parent = tabButton

		table.insert(categoryButtons, tabButton)

		tabButton.MouseButton1Click:Connect(function()
			SoundManager.ButtonClick()
			CURRENT_TAB = category.Name
			allButton.BackgroundColor3 = Color3.fromRGB(40, 40, 45)  -- Reset All to gray
			allButton.TextColor3 = Color3.fromRGB(255, 255, 255)
			for j, btn in pairs(categoryButtons) do
				btn.BackgroundColor3 = Color3.fromRGB(40, 40, 45)  -- Reset all to gray
				btn.TextColor3 = Color3.fromRGB(255, 255, 255)
			end
			tabButton.BackgroundColor3 = category.Color  -- Set THIS button to its color
			tabButton.TextColor3 = Color3.fromRGB(255, 255, 255)
			LOAD_SHOP()
		end)
	end

	-- All button click handler
	allButton.MouseButton1Click:Connect(function()
		SoundManager.ButtonClick()
		CURRENT_TAB = "AllTab"
		allButton.BackgroundColor3 = Color3.fromRGB(100, 70, 140)  -- All button highlight color
		allButton.TextColor3 = Color3.fromRGB(255, 255, 255)
		for _, btn in pairs(categoryButtons) do
			btn.BackgroundColor3 = Color3.fromRGB(40, 40, 45)  -- Reset all categories to gray
			btn.TextColor3 = Color3.fromRGB(255, 255, 255)
		end
		LOAD_SHOP()
	end)

	-- Function to check if item matches search and category
	local function SEARCH_ITEM(ITEM_BUTTON, ITEM_INFO)
		local CAN_SHOW = true

		-- Hide hotspot-only items
		if ITEM_INFO.SpecialTags and ITEM_INFO.SpecialTags.HotspotOnly then
			return false
		end

		-- Search filter
		if string.len(searchBox.Text) > 0 then
			if not string.find(string.lower(ITEM_BUTTON:GetAttribute("ITEM_NAME")), string.lower(searchBox.Text)) then
				CAN_SHOW = false
			end
		end

		-- Category filter
		if CAN_SHOW and CURRENT_TAB ~= "AllTab" then
			if CURRENT_TAB ~= ITEM_INFO.ItemType then
				CAN_SHOW = false
			end
		end

		return CAN_SHOW
	end

	local function IS_ITEM_UNLOCKED(ITEM_ID)
		if INV and INV[ITEM_ID] then
			return INV[ITEM_ID].Unlocked == true
		end
		return false
	end

	LOAD_SHOP = function()
		INV = RepStorage.Events.GetInventoryType:InvokeServer("Items")

		-- Clear existing items
		for _, child in pairs(itemsScroll:GetChildren()) do
			if child:IsA("Frame") then
				child:Destroy()
			end
		end

		for _, ITEM in pairs(RepStorage.Items:GetChildren()) do
			local ITEM_INFO = require(ITEM.ItemStats)
			local isUnlocked = IS_ITEM_UNLOCKED(ITEM_INFO.ItemId)

			-- Create item card with modern styling - RESPONSIVE
			local itemCard = Instance.new("Frame")
			itemCard.Name = "Item" .. ITEM_INFO.ItemId
			itemCard.Size = UDim2.new(1, 0, 1, 0)  -- Sized by GridLayout
			itemCard.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
			itemCard.BackgroundTransparency = 0.2
			itemCard.BorderSizePixel = 0
			itemCard.LayoutOrder = ITEM_INFO.Cost
			itemCard.ZIndex = 8
			itemCard:SetAttribute("ITEM_NAME", ITEM.Name)
			itemCard:SetAttribute("ITEM_ID", ITEM_INFO.ItemId)
			itemCard:SetAttribute("IS_UNLOCKED", isUnlocked)

			

			local cardCorner = Instance.new("UICorner")
			cardCorner.CornerRadius = UDim.new(0, 12)
			cardCorner.Parent = itemCard

			-- Card stroke
			local cardStroke = Instance.new("UIStroke")
			cardStroke.Color = Color3.fromRGB(60, 60, 80)
			cardStroke.Thickness = 1
			cardStroke.Transparency = 0.6
			cardStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
			cardStroke.Parent = itemCard

			-- Item image (converted to scale: 145/155 = 0.9355 width, 140/210 = 0.6667 height)
			local itemImage = Instance.new("ImageLabel")
			itemImage.Size = UDim2.new(0.9355, 0, 0.6667, 0)  -- (155-10)/155 width, 140/210 height
			itemImage.Position = UDim2.new(0.0323, 0, 0.0238, 0)  -- 5/155 = 0.0323, 5/210 = 0.0238
			itemImage.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
			itemImage.BorderSizePixel = 0
			itemImage.Image = ITEM_INFO.ThumbnailId
			itemImage.ImageTransparency = isUnlocked and 0 or 0.5
			itemImage.ZIndex = 9
			itemImage.Parent = itemCard

			local imageCorner = Instance.new("UICorner")
			imageCorner.CornerRadius = UDim.new(0, 10)
			imageCorner.Parent = itemImage

			-- Lock icon (converted to scale: 50/145 = 0.3448 of image size)
			if not isUnlocked then
				local lockIcon = Instance.new("TextLabel")
				lockIcon.Size = UDim2.new(0.3571, 0, 0.3571, 0)  -- 50/140 = 0.3571 (relative to image)
				lockIcon.Position = UDim2.new(0.3214, 0, 0.3214, 0)  -- Centered: (140-50)/2/140 = 0.3214
				lockIcon.BackgroundTransparency = 1
				lockIcon.Text = "ðŸ”’"
				lockIcon.TextSize = 35
				lockIcon.TextScaled = true
				lockIcon.ZIndex = 10
				lockIcon.Parent = itemImage

				-- Text size constraint for lockIcon
				local lockIconConstraint = Instance.new("UITextSizeConstraint")
				lockIconConstraint.MaxTextSize = 35
				lockIconConstraint.Parent = lockIcon
			end

			-- Item name (converted to scale: 145/155 = 0.9355 width, 25/210 = 0.119 height)
			local itemName = Instance.new("TextLabel")
			itemName.Size = UDim2.new(0.9355, 0, 0.119, 0)  -- (155-10)/155 width, 25/210 height
			itemName.Position = UDim2.new(0.0323, 0, 0.7143, 0)  -- 5/155 = 0.0323, 150/210 = 0.7143
			itemName.BackgroundTransparency = 1
			itemName.Text = ITEM.Name
			itemName.TextColor3 = Color3.fromRGB(255, 255, 255)
			itemName.TextSize = 13
			itemName.Font = Enum.Font.GothamBold
			itemName.TextXAlignment = Enum.TextXAlignment.Center
			itemName.TextTruncate = Enum.TextTruncate.AtEnd
			itemName.TextScaled = true
			itemName.ZIndex = 9
			itemName.Parent = itemCard

			-- Text size constraint for itemName
			local itemNameConstraint = Instance.new("UITextSizeConstraint")
			itemNameConstraint.MaxTextSize = 13
			itemNameConstraint.Parent = itemName

			-- Price/Lock label (converted to scale: 145/155 = 0.9355 width, 30/210 = 0.1429 height)
			local priceLabel = Instance.new("TextLabel")
			priceLabel.Size = UDim2.new(0.9355, 0, 0.1429, 0)  -- (155-10)/155 width, 30/210 height
			priceLabel.Position = UDim2.new(0.0323, 0, 0.8333, 0)  -- 5/155 = 0.0323, (210-35)/210 = 0.8333
			priceLabel.BackgroundColor3 = isUnlocked and Color3.fromRGB(70, 130, 70) or Color3.fromRGB(130, 60, 60)
			priceLabel.BackgroundTransparency = 0
			priceLabel.BorderSizePixel = 0
			priceLabel.Text = isUnlocked and ("$" .. CASH_LIB.SUFFIX_NUM(ITEM_INFO.Cost)) or "ðŸ”’ Locked"
			priceLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
			priceLabel.TextSize = 14
			priceLabel.Font = Enum.Font.GothamBold
			priceLabel.TextScaled = true
			priceLabel.ZIndex = 9
			priceLabel.Parent = itemCard

			-- Text size constraint for priceLabel
			local priceLabelConstraint = Instance.new("UITextSizeConstraint")
			priceLabelConstraint.MaxTextSize = 14
			priceLabelConstraint.Parent = priceLabel

			local priceCorner = Instance.new("UICorner")
			priceCorner.CornerRadius = UDim.new(0, 8)
			priceCorner.Parent = priceLabel

			-- Price label stroke
			local priceStroke = Instance.new("UIStroke")
			priceStroke.Color = Color3.fromRGB(0, 0, 0)
			priceStroke.Thickness = 1
			priceStroke.Transparency = 0.7
			priceStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
			priceStroke.Parent = priceLabel

			itemCard.Visible = SEARCH_ITEM(itemCard, ITEM_INFO)

			-- Click button (invisible overlay)
			local clickButton = Instance.new("TextButton")
			clickButton.Size = UDim2.new(1, 0, 1, 0)
			clickButton.BackgroundTransparency = 1
			clickButton.Text = ""
			clickButton.ZIndex = 10
			clickButton.Parent = itemCard

			-- Click handler
			clickButton.MouseButton1Click:Connect(function()
				if DB then
					SoundManager.ButtonClick()
					DB = false
					SELECTED_ITEM = ITEM
					CURRENT_COST = ITEM_INFO.Cost
					AMOUNT = 1

					selectedIcon.Image = ITEM_INFO.ThumbnailId
					selectedName.Text = ITEM.Name

					-- Set description with unlock requirement if locked
					if isUnlocked then
						selectedDesc.Text = ITEM_INFO.Description
					else
						-- Get unlock requirement from server
						local unlockResearch = RepStorage.Events.GetItemUnlockRequirement:InvokeServer(ITEM_INFO.ItemId)
						if unlockResearch then
							selectedDesc.Text = "ðŸ”’ LOCKED - Complete: " .. unlockResearch.Name .. "\n\n" .. ITEM_INFO.Description
						else
							selectedDesc.Text = "ðŸ”’ LOCKED\n\n" .. ITEM_INFO.Description
						end
					end

					amountLabel.Text = "1"

					-- Get tier info
					local MainLib = require(RepStorage.Modules.MainLib)
					local tierName, tierData = MainLib.GET_ITEM_TIER_INFO(ITEM.Name)
					selectedTier.Text = tierName or ("Tier " .. ITEM_INFO.TierId)
					selectedTier.TextColor3 = tierData and tierData["TIER_COLOR"] or Color3.fromRGB(150, 150, 150)

					if isUnlocked then
						buyButton.Text = "ðŸ’° Buy - $" .. CASH_LIB.SUFFIX_NUM(ITEM_INFO.Cost)
						buyButton.BackgroundColor3 = Color3.fromRGB(70, 130, 70)
					else
						buyButton.Text = "ðŸ”’ LOCKED"
						buyButton.BackgroundColor3 = Color3.fromRGB(130, 50, 50)
					end

					selectedPanel.Visible = true
					wait(0.1)
					DB = true
				end
			end)

			-- Hover handlers
			clickButton.MouseEnter:Connect(function()
				script.Parent.Parent.ItemHover.ButtonHovering.Value = itemCard
			end)

			clickButton.MouseLeave:Connect(function()
				if script.Parent.Parent.ItemHover.ButtonHovering.Value == itemCard then
					script.Parent.Parent.ItemHover.ButtonHovering.Value = nil
				end
			end)

			itemCard.Parent = itemsScroll
		end

		-- Update canvas size
		itemsScroll.CanvasSize = UDim2.new(0, 0, 0, itemsGrid.AbsoluteContentSize.Y + 60)
	end

	-- Amount controls
	decreaseBtn.MouseButton1Click:Connect(function()
		AMOUNT = math.max(1, AMOUNT - 1)
		amountLabel.Text = tostring(AMOUNT)
		if SELECTED_ITEM then
			local ITEM_INFO = require(SELECTED_ITEM.ItemStats)
			buyButton.Text = "ðŸ’° Buy - $" .. CASH_LIB.SUFFIX_NUM(ITEM_INFO.Cost * AMOUNT)
		end
	end)

	increaseBtn.MouseButton1Click:Connect(function()
		AMOUNT = math.min(99, AMOUNT + 1)
		amountLabel.Text = tostring(AMOUNT)
		if SELECTED_ITEM then
			local ITEM_INFO = require(SELECTED_ITEM.ItemStats)
			buyButton.Text = "ðŸ’° Buy - $" .. CASH_LIB.SUFFIX_NUM(ITEM_INFO.Cost * AMOUNT)
		end
	end)

	-- Buy button
	buyButton.MouseButton1Click:Connect(function()
		if DB and SELECTED_ITEM then
			DB = false
			local ITEM_INFO = require(SELECTED_ITEM.ItemStats)

			if IS_ITEM_UNLOCKED(ITEM_INFO.ItemId) then
				local ITEM_BOUGHT = RepStorage.Events.BuyItem:InvokeServer(ITEM_INFO.ItemId, math.floor(AMOUNT))
				if ITEM_BOUGHT then
					SoundManager.Purchase()
					LOAD_SHOP()
				else
					SoundManager.Error()
				end
			else
				SoundManager.Error()
			end

			wait(0.1)
			DB = true
		end
	end)

	-- Cancel button
	cancelButton.MouseButton1Click:Connect(function()
		SELECTED_ITEM = nil
		selectedPanel.Visible = false
	end)

	-- Search handlers
	searchBox:GetPropertyChangedSignal("Text"):Connect(function()
		clearButton.Visible = string.len(searchBox.Text) > 0
		LOAD_SHOP()
	end)

	-- Store original jump settings
	local originalJumpPower = nil
	local originalJumpHeight = nil

	-- Menu toggle handler
	script.Parent.MenuObject.Changed:Connect(function()
		if script.Parent.MenuObject.Value then
			shopFrame.Visible = true
			LOAD_SHOP()

			-- Disable jumping when shop opens
			if Plr.Character and Plr.Character:FindFirstChild("Humanoid") then
				local humanoid = Plr.Character.Humanoid

				-- Store original values
				if humanoid.UseJumpPower then
					originalJumpPower = humanoid.JumpPower
					humanoid.JumpPower = 0
				else
					originalJumpHeight = humanoid.JumpHeight
					humanoid.JumpHeight = 0
				end
			end

			-- Hide mobile controls
			if isMobile then
				GuiService:SetCoreGuiEnabled(Enum.CoreGuiType.All, false)
			end
		else
			shopFrame.Visible = false
			selectedPanel.Visible = false

			-- Restore jumping when shop closes
			if Plr.Character and Plr.Character:FindFirstChild("Humanoid") then
				local humanoid = Plr.Character.Humanoid

				-- Restore original values
				if originalJumpPower then
					humanoid.JumpPower = originalJumpPower
				end
				if originalJumpHeight then
					humanoid.JumpHeight = originalJumpHeight
				end
			end

			-- Restore mobile controls
			if isMobile then
				GuiService:SetCoreGuiEnabled(Enum.CoreGuiType.All, true)
			end
		end
	end)
end

return module
